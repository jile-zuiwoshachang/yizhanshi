<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yizhanshi.talent.mapper.LabelMapper">

    <resultMap type="com.yizhanshi.talent.domain.Label" id="LabelResult">
        <id     property="labelId"       column="label_id"      />
        <result property="labelName"       column="label_name"      />
        <result property="labelType"     column="label_type"    />
        <result property="status"     column="status"    />
        <result property="delFlag"     column="del_flag"    />
        <result property="createTime"     column="create_time"    />
        <result property="createBy"     column="create_by"    />
        <result property="updateTime"     column="update_time"    />
        <result property="updateBy"     column="update_by"    />
        <result property="remark"     column="remark"    />
    </resultMap>

    <sql id="selectLabelVo">
        select p.label_id, p.label_name, p.label_type,
        p.status, p.del_flag,p.create_by, p.create_time, p.remark
        from business_label p
    </sql>
    <select id="selectLabelList" parameterType="com.yizhanshi.talent.domain.Label" resultMap="LabelResult">
       <include refid="selectLabelVo"></include>
        where p.del_flag = '0'
        <if test="labelId != null and labelId != 0">
            AND p.label_id = #{labelId}
        </if>
        <if test="labelName != null and labelName != ''">
            AND p.label_name like concat('%', #{labelName}, '%')
        </if>
        <if test="labelType != null and labelType != ''">
            AND p.label_type like concat('%', #{labelType}, '%')
        </if>
        <if test="status != null and status != ''">
            AND p.status = #{status}
        </if>
        <if test="params.beginTime != null and params.beginTime != ''"><!-- 开始时间检索 -->
            AND date_format(p.create_time,'%Y%m%d') &gt;= date_format(#{params.beginTime},'%Y%m%d')
        </if>
        <if test="params.endTime != null and params.endTime != ''"><!-- 结束时间检索 -->
            AND date_format(p.create_time,'%Y%m%d') &lt;= date_format(#{params.endTime},'%Y%m%d')
        </if>
    </select>
    <select id="selectLabelById" parameterType="Long" resultMap="LabelResult">
        <include refid="selectLabelVo">
        </include>
        where p.label_id=#{labelId}
    </select>

    <insert id="insertLabel" parameterType="com.yizhanshi.talent.domain.Label" useGeneratedKeys="true" keyProperty="labelId">
        insert into business_label (
        <if test="labelId != null and labelId != 0">label_id,</if>
        <if test="labelName != null and labelName != ''">label_name,</if>
        <if test="labelType != null and labelType != ''">label_type,</if>
        <if test="status != null and status != ''">status,</if>
        <if test="createBy != null and createBy != ''">create_by,</if>
        <if test="remark != null and remark != ''">remark,</if>
        create_time
        )values(
        <if test="labelId != null and labelId != 0">#{labelId},</if>
        <if test="labelName != null and labelName != ''">#{labelName},</if>
        <if test="labelType != null and labelType != ''">#{labelType},</if>
        <if test="status != null and status != ''">#{status},</if>
        <if test="createBy != null and createBy != ''">#{createBy},</if>
        <if test="remark != null and remark != ''">#{remark},</if>
        sysdate()
        )
    </insert>

    <update id="updateLabel" parameterType="com.yizhanshi.talent.domain.Label">
        update business_label
        <set>
            <if test="labelName != null and labelName != ''">label_name=#{labelName},</if>
            <if test="labelType != null and labelType != ''">label_type=#{labelType},</if>
            <if test="status != null and status != ''">status=#{status},</if>
            <if test="updateBy != null and updateBy != ''">update_by=#{updateBy},</if>
            <if test="remark != null and remark != ''">remark=#{remark},</if>
            update_time = sysdate()
        </set>
        where label_id = #{labelId}
    </update>
    <delete id="deleteLabel" parameterType="Long">
        update business_label set del_flag = '2' where label_id in
        <foreach collection="array" item="labelId" open="(" separator="," close=")">
            #{labelId}
        </foreach>
    </delete>
    <select id="selectAllType" resultType="String">
        select distinct label_type from business_label
        where del_flag='0' and status='0'
    </select>



</mapper>